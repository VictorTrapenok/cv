"use strict";(self.webpackChunkviktor_t=self.webpackChunkviktor_t||[]).push([[1610],{9961:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>a,toc:()=>h});var n=i(4848),s=i(8453);const o={slug:"Testing-for-Telegram-Bots",title:"Integration Testing for Telegram Bots",authors:["viktor"],tags:["Integration-Testing","E2E","Telegram","Testing"]},r=void 0,a={permalink:"/blog/Testing-for-Telegram-Bots",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2019-04-20-cypress-for-telegram/index.md",source:"@site/blog/2019-04-20-cypress-for-telegram/index.md",title:"Integration Testing for Telegram Bots",description:"This is the text of my speech at the FAR EAST Devops DAYS conference",date:"2019-04-20T00:00:00.000Z",tags:[{inline:!0,label:"Integration-Testing",permalink:"/blog/tags/integration-testing"},{inline:!0,label:"E2E",permalink:"/blog/tags/e-2-e"},{inline:!0,label:"Telegram",permalink:"/blog/tags/telegram"},{inline:!0,label:"Testing",permalink:"/blog/tags/testing"}],readingTime:3.435,hasTruncateMarker:!1,authors:[{name:"Viktor Trapenok",title:"Principal Engineer @ Nanoheal",url:"https://www.linkedin.com/in/victor-trapenok/",page:{permalink:"/blog/authors/viktor"},socials:{github:"https://github.com/VictorTrapenok",linkedin:"https://www.linkedin.com/in/victor-trapenok/"},imageURL:"https://viktor-t.com/img/me.jpeg",key:"viktor"}],frontMatter:{slug:"Testing-for-Telegram-Bots",title:"Integration Testing for Telegram Bots",authors:["viktor"],tags:["Integration-Testing","E2E","Telegram","Testing"]},unlisted:!1,prevItem:{title:"Reducing CI/CD infrastructure costs",permalink:"/blog/karpenter-for-gitlabrunner"}},l={authorsImageUrls:[void 0]},h=[{value:"The Project Context",id:"the-project-context",level:2},{value:"The Challenge of Finding Existing Libraries",id:"the-challenge-of-finding-existing-libraries",level:2},{value:"My Solution: Testing via Telegram Web",id:"my-solution-testing-via-telegram-web",level:2},{value:"How It Works",id:"how-it-works",level:2},{value:"Limitations",id:"limitations",level:2},{value:"Key Benefits",id:"key-benefits",level:2},{value:"Future Plans",id:"future-plans",level:2},{value:"Conclusion",id:"conclusion",level:2}];function c(e){const t={a:"a",h2:"h2",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(t.p,{children:["This is the text of my speech at the ",(0,n.jsx)(t.a,{href:"https://www.youtube.com/watch?v=QO2FQZCoggA&t=105s",children:"FAR EAST Devops DAYS conference"}),"\nabout my experience with ",(0,n.jsx)(t.strong,{children:"integration testing for Telegram bots"}),". Specifically, I\u2019ll discuss the challenges and solutions I encountered when testing a Telegram bot that I inherited as part of a project."]}),"\n",(0,n.jsx)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/QO2FQZCoggA?si=6DjHPXJct4Yttc6c&start=73",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerpolicy:"strict-origin-when-cross-origin",allowfullscreen:!0}),"\n",(0,n.jsx)(t.h2,{id:"the-project-context",children:"The Project Context"}),"\n",(0,n.jsxs)(t.p,{children:["The bot was originally written in PHP using the ",(0,n.jsx)(t.strong,{children:"MadelineProto"})," library. For those unfamiliar with this library, it's quite versatile. It not only allows you to create traditional Telegram bots, but it also supports automating actions on behalf of user accounts, which opens up possibilities that regular bots don't offer, such as making audio calls."]}),"\n",(0,n.jsxs)(t.p,{children:["When I joined the project, the bot already had a significant amount of code. However, ",(0,n.jsx)(t.strong,{children:"there were no tests"})," whatsoever. As you can imagine, this was a major productivity bottleneck since I had to manually test the bot\u2019s functionality at the end of each workday. Writing tests became my priority to speed up development."]}),"\n",(0,n.jsx)(t.h2,{id:"the-challenge-of-finding-existing-libraries",children:"The Challenge of Finding Existing Libraries"}),"\n",(0,n.jsxs)(t.p,{children:["My initial approach was to search for existing libraries that could facilitate the testing process. However, after some research, I found that most of the libraries available were written in ",(0,n.jsx)(t.strong,{children:"Node.js"}),", which wasn't ideal for my PHP-based bot. Integrating them would have taken considerable time and effort, and they wouldn\u2019t have allowed me to test the bot directly through Telegram\u2019s API."]}),"\n",(0,n.jsx)(t.h2,{id:"my-solution-testing-via-telegram-web",children:"My Solution: Testing via Telegram Web"}),"\n",(0,n.jsxs)(t.p,{children:["Given the limitations, I decided on a simpler approach: ",(0,n.jsx)(t.strong,{children:"testing the bot through Telegram Web"}),". By interacting with the bot via the web interface, I could simulate user actions like sending messages and clicking buttons. To achieve this, I wrote a small set of functions/scripts that automated these actions, which I\u2019ll share with you later in this post."]}),"\n",(0,n.jsx)(t.p,{children:"This approach was quite effective. The script would send messages to the bot, click buttons, and perform other necessary tasks, saving me hours of manual testing."}),"\n",(0,n.jsx)(t.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,n.jsx)(t.p,{children:"Here\u2019s a brief overview of how the testing script operates:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Open Telegram Web"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Inject the testing script"})," into the browser\u2019s developer console."]}),"\n",(0,n.jsx)(t.li,{children:"The script then automates interactions with the bot, simulating a real user."}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"You can run the test, and while it\u2019s running, you can relax with a cup of tea or work on something else. Once the test is completed, you get the results\u200a\u2014\u200awhether the bot passed or if there were any issues."}),"\n",(0,n.jsx)(t.h2,{id:"limitations",children:"Limitations"}),"\n",(0,n.jsxs)(t.p,{children:["The main drawback of this approach is that it ",(0,n.jsx)(t.strong,{children:"doesn\u2019t provide a full testing cycle"}),". Ideally, I would integrate this with ",(0,n.jsx)(t.strong,{children:"Selenium"})," to run tests automatically from a console or CI/CD pipeline, but so far, I\u2019ve encountered issues with authenticating in Telegram via Selenium."]}),"\n",(0,n.jsx)(t.p,{children:"Another limitation is that Telegram has multiple platforms (iOS, Android, web), and they don\u2019t always behave the same way. For example, the layout of messages may differ across platforms, which makes it hard to test the user experience consistently."}),"\n",(0,n.jsx)(t.h2,{id:"key-benefits",children:"Key Benefits"}),"\n",(0,n.jsxs)(t.p,{children:["Despite its limitations, this was the ",(0,n.jsx)(t.strong,{children:"quickest and easiest"})," way to introduce some form of test automation into the project, which initially had none. It significantly improved our development speed and confidence in the bot\u2019s functionality."]}),"\n",(0,n.jsx)(t.p,{children:"Here\u2019s a simple example of how you can test a scenario using the script:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Send a message"})," to the bot."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Check the bot\u2019s response"})," for expected text."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Click a button"})," in the bot\u2019s response."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Wait for the next message"})," and verify it."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"future-plans",children:"Future Plans"}),"\n",(0,n.jsxs)(t.p,{children:["One of my future goals is to integrate ",(0,n.jsx)(t.strong,{children:"Selenium"})," more effectively for even better automation. However, for now, this solution works, and it\u2019s saving a lot of manual effort."]}),"\n",(0,n.jsx)(t.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,n.jsxs)(t.p,{children:["To summarize, if you\u2019re working on a Telegram bot and need a quick way to set up integration tests, testing through ",(0,n.jsx)(t.strong,{children:"Telegram Web"})," is a simple and effective solution. Although it doesn\u2019t offer full coverage and automation, it\u2019s a great starting point when no tests are in place."]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.p,{children:"Feel free to ask any questions in the comments or reach out to me directly. Thank you for reading!"})]})}function d(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>a});var n=i(6540);const s={},o=n.createContext(s);function r(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);